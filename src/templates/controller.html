{% extends "layout.html" %}

{% block title %}TelloBoard{% endblock %}

{% block content %}

<div class="container-fluid">
    <div class="row">
        <nav id="sidebar" class="col-md-3 col-lg-2 d-md-block bg-light vh-100 sidebar collapse">
            <!--サイドバー-->
            <style>
                .controller-box {
                    text-align: center;
                }
            </style>
            
            <script>
                function sendCommand(command, params={}) {
                    console.log({action: 'sendcommand', command: command, params: params})
                    params['command'] = command
                    $.post("/api/command/", params).done(function (json) {
                        console.log({action: 'sendCommand', json: json})
                    }, 'json')
                }

                $(document).on('pageinit', function() {
                    $('#slider-speed').on("slidestop", function(event) {
                        let params = {
                            speed: $("#slider-speed").val(),
                        }
                        sendCommand('speed', params)
                    })
                })
            </script>
            
            <div class="controller-box pt-4">
                <h3>Controller</h3>
            </div>
            
            <div class="controller-box">
                <div class="btn-group py-2" role="group" aria-label="Basic outlined example">
                    <button type="button" class="btn btn-outline-primary" onclick="sendCommand('takeOff'); return false">Take Off</button>
                    <button type="button" class="btn btn-outline-primary" onclick="sendCommand('land'); return false">Land</button>
                </div>
            </div>
            <div style="display: flex; justify-content: center;" class="py-2">
                <table class="text-center">
                    <td class="px-2">
                        <div class="text-center">
                            <div class="ui-nodisc-icon ui-alt-icon">
                                <button type="button" class="btn btn-outline-primary" onclick="sendCommand('up'); return false;">
                                    <i class="bi bi-chevron-double-up"></i>
                                </button>
                            </div>
                            <div class="ui-nodisc-icon ui-alt-icon">
                                <button type="button" class="btn btn-outline-primary" onclick="sendCommand('turnLeft'); return false;">
                                    <i class="bi bi-arrow-clockwise"></i>
                                </button>
                                <button type="button" class="btn btn-outline-primary" onclick="sendCommand('turnRight'); return false;">
                                    <i class="bi bi-arrow-counterclockwise"></i>
                                </button>
                            </div>
                            <div class="ui-nodisc-icon ui-alt-icon">
                                <button type="button" class="btn btn-outline-primary" onclick="sendCommand('down'); return false;">
                                    <i class="bi bi-chevron-double-down"></i>
                                </button>
                            </div>
                        </div>
                    </td>
            
                    <td class="px-2">
                        <div style="text-align: center;">
                            <div class="ui-nodisc-icon ui-alt-icon">
                                <button type="button" class="btn btn-outline-primary" onclick="sendCommand('forward'); return false;">
                                    <i class="bi bi-arrow-up"></i>
                                </button>
                            </div>
                            <div class="ui-nodisc-icon ui-alt-icon">
                                <button type="button" class="btn btn-outline-primary" onclick="sendCommand('left'); return false;">
                                    <i class="bi bi-arrow-left"></i>
                                </button>
                                <button type="button" class="btn btn-outline-primary" onclick="sendCommand('right'); return false;">
                                    <i class="bi bi-arrow-right"></i>
                                </button>
                            </div>
                            <div class="ui-nodisc-icon ui-alt-icon">
                                <button type="button" class="btn btn-outline-primary" onclick="sendCommand('back'); return false;">
                                    <i class="bi bi-arrow-down"></i>
                                </button>
                            </div>
                        </div>
                    </td>
                </table>
            </div>
        </nav>
        <main class="col-md-9 ml-sm-auto col-lg-10 px-md-4 py-4">
            <div class="accordion" id="accordionPanelsStayOpen">
                <div class="accordion-item">
                    <h2 class="accordion-header" id="panelsStayOpen-headingCamera">
                        <button class="accordion-button" type="button" data-bs-toggle="collapse"
                        data-bs-target="#panelsStayOpen-collapseCamera" aria-expanded="true"
                        aria-controls="panelsStayOpen-collapseCamera">
                            Camera
                        </button>
                    </h2>
                    <div id="panelsStayOpen-collapseCamera" class="accordion-collapse collapse show" aria-labelledby="panelsStayOpen-headingOne">
                        <div class="accordion-body text-center">
                            <!--ドローンカメラ映像-->
                            <img src="/video/streaming" class="img-thumbnail" 
                                width="400" height="300">
                        </div>
                    </div>
                </div>
                <div class="accordion-item">
                  <h2 class="accordion-header" id="panelsStayOpen-headingStatus">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                        data-bs-target="#panelsStayOpen-collapseStatus" aria-expanded="false"
                        aria-controls="panelsStayOpen-collapseStatus">
                            Status
                    </button>
                  </h2>
                  <div id="panelsStayOpen-collapseStatus" class="accordion-collapse collapse" aria-labelledby="panelsStayOpen-headingStatus">
                    <div class="accordion-body">
                        <ul class="list-group list-group-flush">
                            <li class="list-group-item">
                                <i class="bi bi-command"></i>
                            </li>
                            <li class="list-group-item">
                                <i class="bi bi-speedometer"></i>
                            </li>
                            <li class="list-group-item">
                                <i class="bi bi-thermometer"></i>
                            </li>
                            <li class="list-group-item">
                                <i class="bi bi-clock"></i>
                            </li>
                            <li class="list-group-item">
                                <i class="bi bi-battery"></i>
                            </li>
                        </ul>
                    </div>
                  </div>
                </div>
              </div>
        </main>
    </div>
</div>

{% endblock %}